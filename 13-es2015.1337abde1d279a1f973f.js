(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{XpXM:function(t,e,n){"use strict";n.r(e),n.d(e,"MainPageModule",(function(){return v}));var i=n("ofXK"),o=n("3Pt+"),r=n("TEn/"),s=n("tyNb"),c=n("mrSG"),a=n("tk/3"),l=n("z6cu"),b=n("JIr8"),d=n("fXoL"),p=n("e8h1");function u(t,e){if(1&t){const t=d.Lb();d.Kb(0,"ion-button",7),d.Sb("click",(function(){return d.bc(t),d.Ub().reload()})),d.fc(1,"\u91cd\u65b0\u8f09\u5165"),d.Jb()}}function h(t,e){if(1&t){const t=d.Lb();d.Kb(0,"ion-button",7),d.Sb("click",(function(){return d.bc(t),d.Ub().nav2login()})),d.fc(1,"\u767b\u5165"),d.Jb()}}function f(t,e){if(1&t){const t=d.Lb();d.Kb(0,"ion-item",8),d.Kb(1,"ion-label",9),d.Sb("click",(function(){d.bc(t);const n=e.$implicit;return d.Ub().nav2update(n.id)})),d.Kb(2,"span"),d.fc(3),d.Jb(),d.Ib(4,"br"),d.Kb(5,"span",10),d.fc(6),d.Jb(),d.Kb(7,"span",11),d.fc(8),d.Jb(),d.Jb(),d.Kb(9,"span",12),d.fc(10),d.Vb(11,"date"),d.Jb(),d.Kb(12,"span",13),d.fc(13),d.Jb(),d.Kb(14,"ion-button",14),d.Sb("click",(function(){d.bc(t);const n=e.$implicit;return d.Ub().DeleteItem(n.id)})),d.fc(15,"delete"),d.Jb(),d.Jb()}if(2&t){const t=e.$implicit;d.xb(3),d.gc(" ",t.id,". "),d.xb(3),d.gc(" ",t.title," "),d.xb(2),d.gc(" ",t.description," "),d.xb(2),d.gc(" \u6700\u5f8c\u4fee\u6539\u6642\u9593\uff1a ",d.Wb(11,5,t.updated_at,"short")," "),d.xb(3),d.gc(" last edited by ",t.last_edited_by_user.name," ")}}const g=[{path:"",component:(()=>{class t{constructor(t,e,n,i,o){this.navCtrl=t,this.http=e,this.alertController=n,this.router=i,this.storage=o,this.rawResponse=null,this.errorFlag=!1,this.accessToken="",this.handleError=t=>(t.error instanceof ErrorEvent?console.error("An error occurred:",t.error.message):console.error(`HTTP status code ${t.status}, reason:`,t.error),Object(l.a)("Something bad happened; please try again later."))}ngOnInit(){return Object(c.a)(this,void 0,void 0,(function*(){this.accessToken=String(yield this.storage.get("Token")),this.initialize()}))}initialize(){return Object(c.a)(this,void 0,void 0,(function*(){try{const t=yield this.getAllNotificationsFromApi();console.log(t.data),this.errorFlag=!1,this.data=t.data,this.rawResponse=t}catch(t){console.error(t),this.errorFlag=!0,Object(b.a)(this.handleError),this.presentErrorAlert()}}))}getAllNotificationsFromApi(){return Object(c.a)(this,void 0,void 0,(function*(){const t={headers:new a.c({Authorization:"Bearer "+this.accessToken})};return yield this.http.get("https://api.next.cocoing.info/admin/notifications",t).toPromise()}))}presentErrorAlert(){return Object(c.a)(this,void 0,void 0,(function*(){(yield this.alertController.create({header:"\u767c\u751f\u932f\u8aa4",message:"\u8f09\u5165\u5931\u6557\uff0c\u8acb\u91cd\u65b0\u8f09\u5165",buttons:["OK"]})).present()}))}reload(){this.initialize()}DeleteItem(t){return Object(c.a)(this,void 0,void 0,(function*(){try{const e=yield this.DeleteNotificationsFromApi(t);console.log({response:e})}catch(e){console.error("catch error!"),Object(b.a)(this.handleError)}}))}DeleteNotificationsFromApi(t){return Object(c.a)(this,void 0,void 0,(function*(){return new Promise((e,n)=>{const i={id:t},o={headers:new a.c({Authorization:"Bearer "+this.accessToken,"X-HTTP-Method-Override":"delete"})};this.http.post("https://api.next.cocoing.info/admin/notifications",i,o).subscribe(t=>{console.log(t),this.presentDeleteAlert(),this.reload(),e(t)},t=>{console.error(t),this.presentFailDeleteAlert(),n(t)})})}))}presentDeleteAlert(){return Object(c.a)(this,void 0,void 0,(function*(){(yield this.alertController.create({header:"\u522a\u9664\u6210\u529f",message:"\u8cc7\u6599\u5df2\u522a\u9664\u6210\u529f",buttons:["OK"]})).present()}))}presentFailDeleteAlert(){return Object(c.a)(this,void 0,void 0,(function*(){(yield this.alertController.create({header:"\u522a\u9664\u5931\u6557",message:"\u8cc7\u6599\u522a\u9664\u5931\u6557",buttons:["OK"]})).present()}))}add_notification(){this.navCtrl.navigateForward("/add-notification",{state:()=>{this.initialize()}})}nav2update(t){this.navCtrl.navigateForward("/item-update/"+t,{state:()=>{this.reload()}})}nav2login(){this.navCtrl.navigateForward("/login")}}return t.\u0275fac=function(e){return new(e||t)(d.Hb(r.x),d.Hb(a.a),d.Hb(r.a),d.Hb(s.g),d.Hb(p.b))},t.\u0275cmp=d.Bb({type:t,selectors:[["app-main"]],decls:14,vars:3,consts:[["color","dark"],[1,"my_title"],["slot","end"],["color","danger",3,"click"],["expand","full",3,"click"],["expand","full","color","danger",3,"click",4,"ngIf"],["class","item",4,"ngFor","ngForOf"],["expand","full","color","danger",3,"click"],[1,"item"],[3,"click"],[1,"myItemTitle"],[1,"myItemDes"],[1,"my_date"],[1,"user"],["slot","end","color","danger",3,"click"]],template:function(t,e){1&t&&(d.Kb(0,"ion-header"),d.Kb(1,"ion-toolbar",0),d.Kb(2,"ion-title",1),d.fc(3,"\u4e3b\u8981\u9801\u9762"),d.Jb(),d.Kb(4,"ion-buttons",2),d.Kb(5,"ion-button",3),d.Sb("click",(function(){return e.nav2login()})),d.fc(6,"\u767b\u51fa"),d.Jb(),d.Jb(),d.Jb(),d.Jb(),d.Kb(7,"ion-content"),d.Kb(8,"ion-button",4),d.Sb("click",(function(){return e.add_notification()})),d.fc(9,"\u65b0\u589e\u901a\u77e5"),d.Jb(),d.ec(10,u,2,0,"ion-button",5),d.ec(11,h,2,0,"ion-button",5),d.Kb(12,"ion-list"),d.ec(13,f,16,8,"ion-item",6),d.Jb(),d.Jb()),2&t&&(d.xb(10),d.Zb("ngIf",e.errorFlag),d.xb(1),d.Zb("ngIf",e.errorFlag),d.xb(2),d.Zb("ngForOf",e.data))},directives:[r.l,r.u,r.t,r.g,r.f,r.j,i.j,r.q,i.i,r.o,r.p],pipes:[i.d],styles:['@charset "UTF-8";*[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{font-family:\u5fae\u8edf\u6b63\u9ed1\u9ad4}.my_title[_ngcontent-%COMP%]{font-size:25px;margin-left:46.5%;margin-right:45%;padding:10px}.item[_ngcontent-%COMP%]{position:relative}.myItemTitle[_ngcontent-%COMP%]{position:absolute;left:30px;top:0;font-weight:bolder;padding:5px}.myItemDes[_ngcontent-%COMP%]{position:absolute;left:35px;top:25px}.my_date[_ngcontent-%COMP%]{top:3px}.my_date[_ngcontent-%COMP%], .user[_ngcontent-%COMP%]{position:absolute;right:100px;font-size:14px;color:grey}.user[_ngcontent-%COMP%]{bottom:5px;padding-top:2px}@media (max-width:1213px){.my_title[_ngcontent-%COMP%]{font-size:25px;margin-left:35%}}@media (max-width:768px){.my_date[_ngcontent-%COMP%], .user[_ngcontent-%COMP%]{display:none}}']}),t})()}];let m=(()=>{class t{}return t.\u0275mod=d.Fb({type:t}),t.\u0275inj=d.Eb({factory:function(e){return new(e||t)},imports:[[s.i.forChild(g)],s.i]}),t})(),v=(()=>{class t{}return t.\u0275mod=d.Fb({type:t}),t.\u0275inj=d.Eb({factory:function(e){return new(e||t)},imports:[[i.b,o.a,r.v,m]]}),t})()}}]);