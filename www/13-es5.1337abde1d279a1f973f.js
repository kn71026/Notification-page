!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{XpXM:function(n,r,i){"use strict";i.r(r),i.d(r,"MainPageModule",(function(){return O}));var o=i("ofXK"),a=i("3Pt+"),c=i("TEn/"),s=i("tyNb"),u=i("mrSG"),l=i("tk/3"),b=i("z6cu"),p=i("JIr8"),f=i("fXoL"),d=i("e8h1");function h(e,t){if(1&e){var n=f.Lb();f.Kb(0,"ion-button",7),f.Sb("click",(function(){return f.bc(n),f.Ub().reload()})),f.fc(1,"\u91cd\u65b0\u8f09\u5165"),f.Jb()}}function g(e,t){if(1&e){var n=f.Lb();f.Kb(0,"ion-button",7),f.Sb("click",(function(){return f.bc(n),f.Ub().nav2login()})),f.fc(1,"\u767b\u5165"),f.Jb()}}function m(e,t){if(1&e){var n=f.Lb();f.Kb(0,"ion-item",8),f.Kb(1,"ion-label",9),f.Sb("click",(function(){f.bc(n);var e=t.$implicit;return f.Ub().nav2update(e.id)})),f.Kb(2,"span"),f.fc(3),f.Jb(),f.Ib(4,"br"),f.Kb(5,"span",10),f.fc(6),f.Jb(),f.Kb(7,"span",11),f.fc(8),f.Jb(),f.Jb(),f.Kb(9,"span",12),f.fc(10),f.Vb(11,"date"),f.Jb(),f.Kb(12,"span",13),f.fc(13),f.Jb(),f.Kb(14,"ion-button",14),f.Sb("click",(function(){f.bc(n);var e=t.$implicit;return f.Ub().DeleteItem(e.id)})),f.fc(15,"delete"),f.Jb(),f.Jb()}if(2&e){var r=t.$implicit;f.xb(3),f.gc(" ",r.id,". "),f.xb(3),f.gc(" ",r.title," "),f.xb(2),f.gc(" ",r.description," "),f.xb(2),f.gc(" \u6700\u5f8c\u4fee\u6539\u6642\u9593\uff1a ",f.Wb(11,5,r.updated_at,"short")," "),f.xb(3),f.gc(" last edited by ",r.last_edited_by_user.name," ")}}var v,x,k,y=[{path:"",component:(v=function(){function n(t,r,i,o,a){e(this,n),this.navCtrl=t,this.http=r,this.alertController=i,this.router=o,this.storage=a,this.rawResponse=null,this.errorFlag=!1,this.accessToken="",this.handleError=function(e){return e.error instanceof ErrorEvent?console.error("An error occurred:",e.error.message):console.error("HTTP status code ".concat(e.status,", reason:"),e.error),Object(b.a)("Something bad happened; please try again later.")}}var r,i,o;return r=n,(i=[{key:"ngOnInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=String,e.next=3,this.storage.get("Token");case 3:e.t1=e.sent,this.accessToken=(0,e.t0)(e.t1),this.initialize();case 6:case"end":return e.stop()}}),e,this)})))}},{key:"initialize",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getAllNotificationsFromApi();case 3:t=e.sent,console.log(t.data),this.errorFlag=!1,this.data=t.data,this.rawResponse=t,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),this.errorFlag=!0,Object(p.a)(this.handleError),this.presentErrorAlert();case 10:case"end":return e.stop()}}),e,this,[[0,7]])})))}},{key:"getAllNotificationsFromApi",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={headers:new l.c({Authorization:"Bearer "+this.accessToken})},e.next=3,this.http.get("https://api.next.cocoing.info/admin/notifications",t).toPromise();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"presentErrorAlert",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({header:"\u767c\u751f\u932f\u8aa4",message:"\u8f09\u5165\u5931\u6557\uff0c\u8acb\u91cd\u65b0\u8f09\u5165",buttons:["OK"]});case 2:e.sent.present();case 3:case"end":return e.stop()}}),e,this)})))}},{key:"reload",value:function(){this.initialize()}},{key:"DeleteItem",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.DeleteNotificationsFromApi(e);case 3:n=t.sent,console.log({response:n}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("catch error!"),Object(p.a)(this.handleError);case 10:case"end":return t.stop()}}),t,this,[[0,7]])})))}},{key:"DeleteNotificationsFromApi",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){var i={id:e},o={headers:new l.c({Authorization:"Bearer "+n.accessToken,"X-HTTP-Method-Override":"delete"})};n.http.post("https://api.next.cocoing.info/admin/notifications",i,o).subscribe((function(e){console.log(e),n.presentDeleteAlert(),n.reload(),t(e)}),(function(e){console.error(e),n.presentFailDeleteAlert(),r(e)}))})));case 1:case"end":return t.stop()}}),t)})))}},{key:"presentDeleteAlert",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({header:"\u522a\u9664\u6210\u529f",message:"\u8cc7\u6599\u5df2\u522a\u9664\u6210\u529f",buttons:["OK"]});case 2:e.sent.present();case 3:case"end":return e.stop()}}),e,this)})))}},{key:"presentFailDeleteAlert",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({header:"\u522a\u9664\u5931\u6557",message:"\u8cc7\u6599\u522a\u9664\u5931\u6557",buttons:["OK"]});case 2:e.sent.present();case 3:case"end":return e.stop()}}),e,this)})))}},{key:"add_notification",value:function(){var e=this;this.navCtrl.navigateForward("/add-notification",{state:function(){e.initialize()}})}},{key:"nav2update",value:function(e){var t=this;this.navCtrl.navigateForward("/item-update/"+e,{state:function(){t.reload()}})}},{key:"nav2login",value:function(){this.navCtrl.navigateForward("/login")}}])&&t(r.prototype,i),o&&t(r,o),n}(),v.\u0275fac=function(e){return new(e||v)(f.Hb(c.x),f.Hb(l.a),f.Hb(c.a),f.Hb(s.g),f.Hb(d.b))},v.\u0275cmp=f.Bb({type:v,selectors:[["app-main"]],decls:14,vars:3,consts:[["color","dark"],[1,"my_title"],["slot","end"],["color","danger",3,"click"],["expand","full",3,"click"],["expand","full","color","danger",3,"click",4,"ngIf"],["class","item",4,"ngFor","ngForOf"],["expand","full","color","danger",3,"click"],[1,"item"],[3,"click"],[1,"myItemTitle"],[1,"myItemDes"],[1,"my_date"],[1,"user"],["slot","end","color","danger",3,"click"]],template:function(e,t){1&e&&(f.Kb(0,"ion-header"),f.Kb(1,"ion-toolbar",0),f.Kb(2,"ion-title",1),f.fc(3,"\u4e3b\u8981\u9801\u9762"),f.Jb(),f.Kb(4,"ion-buttons",2),f.Kb(5,"ion-button",3),f.Sb("click",(function(){return t.nav2login()})),f.fc(6,"\u767b\u51fa"),f.Jb(),f.Jb(),f.Jb(),f.Jb(),f.Kb(7,"ion-content"),f.Kb(8,"ion-button",4),f.Sb("click",(function(){return t.add_notification()})),f.fc(9,"\u65b0\u589e\u901a\u77e5"),f.Jb(),f.ec(10,h,2,0,"ion-button",5),f.ec(11,g,2,0,"ion-button",5),f.Kb(12,"ion-list"),f.ec(13,m,16,8,"ion-item",6),f.Jb(),f.Jb()),2&e&&(f.xb(10),f.Zb("ngIf",t.errorFlag),f.xb(1),f.Zb("ngIf",t.errorFlag),f.xb(2),f.Zb("ngForOf",t.data))},directives:[c.l,c.u,c.t,c.g,c.f,c.j,o.j,c.q,o.i,c.o,c.p],pipes:[o.d],styles:['@charset "UTF-8";*[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{font-family:\u5fae\u8edf\u6b63\u9ed1\u9ad4}.my_title[_ngcontent-%COMP%]{font-size:25px;margin-left:46.5%;margin-right:45%;padding:10px}.item[_ngcontent-%COMP%]{position:relative}.myItemTitle[_ngcontent-%COMP%]{position:absolute;left:30px;top:0;font-weight:bolder;padding:5px}.myItemDes[_ngcontent-%COMP%]{position:absolute;left:35px;top:25px}.my_date[_ngcontent-%COMP%]{top:3px}.my_date[_ngcontent-%COMP%], .user[_ngcontent-%COMP%]{position:absolute;right:100px;font-size:14px;color:grey}.user[_ngcontent-%COMP%]{bottom:5px;padding-top:2px}@media (max-width:1213px){.my_title[_ngcontent-%COMP%]{font-size:25px;margin-left:35%}}@media (max-width:768px){.my_date[_ngcontent-%COMP%], .user[_ngcontent-%COMP%]{display:none}}']}),v)}],w=((k=function t(){e(this,t)}).\u0275mod=f.Fb({type:k}),k.\u0275inj=f.Eb({factory:function(e){return new(e||k)},imports:[[s.i.forChild(y)],s.i]}),k),O=((x=function t(){e(this,t)}).\u0275mod=f.Fb({type:x}),x.\u0275inj=f.Eb({factory:function(e){return new(e||x)},imports:[[o.b,a.a,c.v,w]]}),x)}}])}();