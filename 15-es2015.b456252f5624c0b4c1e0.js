(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{XpXM:function(t,e,n){"use strict";n.r(e),n.d(e,"MainPageModule",(function(){return O}));var o=n("ofXK"),r=n("3Pt+"),i=n("TEn/"),a=n("tyNb"),s=n("mrSG"),c=n("tk/3"),d=n("z6cu"),l=n("JIr8"),p=n("fXoL"),b=n("e8h1");function g(t,e){if(1&t){const t=p.Lb();p.Kb(0,"ion-button",8),p.Sb("click",(function(){return p.dc(t),p.Wb().reload()})),p.hc(1,"\u91cd\u65b0\u8f09\u5165"),p.Jb()}}function u(t,e){if(1&t){const t=p.Lb();p.Kb(0,"ion-button",8),p.Sb("click",(function(){return p.dc(t),p.Wb().nav2login()})),p.hc(1,"\u767b\u5165"),p.Jb()}}function h(t,e){if(1&t){const t=p.Lb();p.Kb(0,"h1",16),p.Kb(1,"a",17),p.Sb("click",(function(){p.dc(t);const e=p.Wb().$implicit;return p.Wb().sendItem(e.id)})),p.hc(2,"send"),p.Jb(),p.Jb()}}function f(t,e){if(1&t){const t=p.Lb();p.Kb(0,"ion-item"),p.Kb(1,"ion-label",9),p.Sb("click",(function(){p.dc(t);const n=e.$implicit;return p.Wb().nav2update(n.id)})),p.Kb(2,"span",10),p.hc(3),p.Jb(),p.Kb(4,"span",11),p.hc(5),p.Jb(),p.Jb(),p.Kb(6,"span",12),p.hc(7),p.Xb(8,"date"),p.Jb(),p.Kb(9,"span",13),p.hc(10),p.Jb(),p.gc(11,h,3,0,"h1",14),p.Kb(12,"ion-icon",15),p.Sb("click",(function(){p.dc(t);const n=e.$implicit;return p.Wb().DeleteItem(n.id)})),p.Jb(),p.Jb()}if(2&t){const t=e.$implicit,n=p.Wb();p.xb(3),p.ic(" ",t.title," "),p.xb(2),p.ic(" ",t.description," "),p.xb(2),p.ic(" \u6700\u5f8c\u4fee\u6539\u6642\u9593\uff1a ",p.Yb(8,5,t.updated_at,"short")," "),p.xb(3),p.ic(" last edited by ",t.last_edited_by_user.name," "),p.xb(1),p.bc("ngIf",t.last_edited_by_user.name===n.nowUser)}}const m=[{path:"",component:(()=>{class t{constructor(t,e,n,o,r){this.navCtrl=t,this.http=e,this.alertController=n,this.router=o,this.storage=r,this.rawResponse=null,this.errorFlag=!1,this.isCreator=!1,this.accessToken="",this.handleError=t=>(t.error instanceof ErrorEvent?console.error("An error occurred:",t.error.message):console.error(`HTTP status code ${t.status}, reason:`,t.error),Object(d.a)("Something bad happened; please try again later."))}ngOnInit(){return Object(s.a)(this,void 0,void 0,(function*(){this.nowUser=String(yield this.storage.get("User")),console.log(this.nowUser),this.accessToken=String(yield this.storage.get("Token")),this.initialize()}))}initialize(){return Object(s.a)(this,void 0,void 0,(function*(){try{const t=yield this.getAllNotificationsFromApi();console.log(t.data),this.errorFlag=!1,this.data=t.data,this.rawResponse=t}catch(t){console.error(t),this.errorFlag=!0,Object(l.a)(this.handleError),this.presentErrorAlert()}}))}getAllNotificationsFromApi(){return Object(s.a)(this,void 0,void 0,(function*(){const t={headers:new c.c({Authorization:"Bearer "+this.accessToken})};return yield this.http.get("https://api.cocoing.info/admin/notifications",t).toPromise()}))}presentErrorAlert(){return Object(s.a)(this,void 0,void 0,(function*(){(yield this.alertController.create({header:"\u767c\u751f\u932f\u8aa4",message:"\u8f09\u5165\u5931\u6557\uff0c\u8acb\u91cd\u65b0\u8f09\u5165",buttons:["OK"]})).present()}))}reload(){this.initialize()}DeleteItem(t){return Object(s.a)(this,void 0,void 0,(function*(){try{const e=yield this.DeleteNotificationsFromApi(t);console.log({response:e})}catch(e){console.error("catch error!"),Object(l.a)(this.handleError)}}))}DeleteNotificationsFromApi(t){return Object(s.a)(this,void 0,void 0,(function*(){return new Promise((e,n)=>{const o={id:t},r={headers:new c.c({Authorization:"Bearer "+this.accessToken,"X-HTTP-Method-Override":"delete"})};this.http.post("https://api.cocoing.info/admin/notifications",o,r).subscribe(t=>{console.log(t),this.presentDeleteAlert(),this.reload(),e(t)},t=>{console.error(t),this.presentFailDeleteAlert(),n(t)})})}))}presentDeleteAlert(){return Object(s.a)(this,void 0,void 0,(function*(){(yield this.alertController.create({header:"\u522a\u9664\u6210\u529f",message:"\u8cc7\u6599\u5df2\u522a\u9664\u6210\u529f",buttons:["OK"]})).present()}))}presentFailDeleteAlert(){return Object(s.a)(this,void 0,void 0,(function*(){(yield this.alertController.create({header:"\u522a\u9664\u5931\u6557",message:"\u8cc7\u6599\u522a\u9664\u5931\u6557",buttons:["OK"]})).present()}))}sendItem(t){return Object(s.a)(this,void 0,void 0,(function*(){try{const e=yield this.sendNotificationsFromApi(t);console.log({response:e})}catch(e){console.error("catch error!"),Object(l.a)(this.handleError)}}))}sendNotificationsFromApi(t){return Object(s.a)(this,void 0,void 0,(function*(){return new Promise((e,n)=>{const o={id:t},r={headers:new c.c({Authorization:"Bearer "+this.accessToken})};this.http.post("https://api.cocoing.info/admin/notifications/send",o,r).subscribe(t=>{console.log(t),this.presentSendAlert(),this.reload(),e(t)},t=>{console.error(t),this.presentFailSendAlert(),n(t)})})}))}presentSendAlert(){return Object(s.a)(this,void 0,void 0,(function*(){(yield this.alertController.create({header:"\u9001\u51fa\u6210\u529f",message:"\u901a\u77e5\u5df2\u6210\u529f\u9001\u51fa",buttons:["OK"]})).present()}))}presentFailSendAlert(){return Object(s.a)(this,void 0,void 0,(function*(){(yield this.alertController.create({header:"\u9001\u51fa\u5931\u6557",message:"\u901a\u77e5\u9001\u51fa\u5931\u6557",buttons:["OK"]})).present()}))}add_notification(){this.navCtrl.navigateForward("/add-notification",{state:()=>{this.initialize()}})}nav2update(t){this.navCtrl.navigateForward("/item-update/"+t,{state:()=>{this.reload()}})}nav2login(){this.navCtrl.navigateForward("/login")}}return t.\u0275fac=function(e){return new(e||t)(p.Hb(i.x),p.Hb(c.a),p.Hb(i.a),p.Hb(a.g),p.Hb(b.b))},t.\u0275cmp=p.Bb({type:t,selectors:[["app-main"]],decls:15,vars:3,consts:[["color","dark"],[1,"my_title"],["slot","end"],[1,"LogOutButton",3,"click"],["expand","full",1,"AddButton",3,"click"],["expand","full","color","danger",3,"click",4,"ngIf"],[1,"ion-text-center"],[4,"ngFor","ngForOf"],["expand","full","color","danger",3,"click"],[1,"item",3,"click"],[1,"myItemTitle"],[1,"myItemDes"],[1,"my_date"],[1,"user"],["class","icon_send",4,"ngIf"],["name","trash-outline",1,"delete_button",2,"cursor","pointer",3,"click"],[1,"icon_send"],[3,"click"]],template:function(t,e){1&t&&(p.Kb(0,"ion-header"),p.Kb(1,"ion-toolbar",0),p.Kb(2,"ion-title",1),p.hc(3,"Main"),p.Jb(),p.Kb(4,"ion-buttons",2),p.Kb(5,"button",3),p.Sb("click",(function(){return e.nav2login()})),p.hc(6,"Logout"),p.Jb(),p.Jb(),p.Jb(),p.Jb(),p.Kb(7,"ion-content"),p.Kb(8,"button",4),p.Sb("click",(function(){return e.add_notification()})),p.hc(9,"\u65b0\u589e\u901a\u77e5"),p.Jb(),p.gc(10,g,2,0,"ion-button",5),p.gc(11,u,2,0,"ion-button",5),p.Kb(12,"div",6),p.Kb(13,"ion-list"),p.gc(14,f,13,8,"ion-item",7),p.Jb(),p.Jb(),p.Jb()),2&t&&(p.xb(10),p.bc("ngIf",e.errorFlag),p.xb(1),p.bc("ngIf",e.errorFlag),p.xb(3),p.bc("ngForOf",e.data))},directives:[i.l,i.u,i.t,i.g,i.j,o.j,i.q,o.i,i.f,i.o,i.p,i.m],pipes:[o.d],styles:['@charset "UTF-8";*[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{font-family:\u5fae\u8edf\u6b63\u9ed1\u9ad4}.ion-text-center[_ngcontent-%COMP%]{border:1px solid #85e0f7;border-radius:20px;padding:10px;margin-top:5%;margin-left:20%;margin-right:20%;box-shadow:0 0 9px #8de6f1}button[_ngcontent-%COMP%]{border:0;margin:20px;text-transform:uppercase;font-size:20px;font-weight:700;padding:15px 60px;border-radius:50px;color:#fff;outline:none;position:relative}button[_ngcontent-%COMP%]:before{content:"";display:block;background:linear-gradient(270deg,hsla(0,0%,100%,0) 50%,hsla(0,0%,100%,.4) 0);background-size:210% 100%;background-position:100% 100%;height:100%;width:100%;position:absolute;top:0;bottom:0;right:0;left:0;border-radius:50px;transition:all 1s;-webkit-transition:all 1s}.LogOutButton[_ngcontent-%COMP%]{border:0;margin:5px;font-size:16px;border-radius:50px;padding:10px;color:#fff;outline:none;position:relative;background-image:linear-gradient(90deg,#e13b25,#e46140);box-shadow:0 2px 15px 0 rgba(248,127,79,.75)}.LogOutButton[_ngcontent-%COMP%]:hover:before{background-position:0 100%}.AddButton[_ngcontent-%COMP%]{margin-left:46.5%;margin-right:45%;border:0;font-size:18px;border-radius:40px;padding:20px;color:#fff;outline:none;background-image:linear-gradient(90deg,#259ce1,#12ddf8);box-shadow:0 2px 15px 0 rgba(20,164,247,.75)}.AddButton[_ngcontent-%COMP%]:hover:before{background-position:0 100%}.my_title[_ngcontent-%COMP%]{font-size:25px;margin-left:51%}.item[_ngcontent-%COMP%], .my_title[_ngcontent-%COMP%]{padding:10px}.myItemTitle[_ngcontent-%COMP%]{top:0;font-weight:bolder}.myItemDes[_ngcontent-%COMP%], .myItemTitle[_ngcontent-%COMP%]{position:absolute;left:5px}.myItemDes[_ngcontent-%COMP%]{top:25px}.my_date[_ngcontent-%COMP%]{top:3px}.my_date[_ngcontent-%COMP%], .user[_ngcontent-%COMP%]{position:absolute;right:100px;font-size:12px;color:grey}.user[_ngcontent-%COMP%]{bottom:5px}.icon_send[_ngcontent-%COMP%]{position:absolute;right:25px;bottom:-3px}.icon_send[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;background-image:url(icon_1.eb54efab3b60d786d2bd.gif);background-size:contain;display:block;text-indent:101%;overflow:hidden;white-space:nowrap;background-repeat:no-repeat}.delete_button[_ngcontent-%COMP%]:hover{color:rgba(240,73,73,.699);-webkit-animation:shake .8s;animation:shake .8s;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite}@-webkit-keyframes shake{0%{transform:translate(1px,1px) rotate(0deg)}10%{transform:translate(-1px,-2px) rotate(-1deg)}20%{transform:translate(-3px) rotate(1deg)}30%{transform:translate(3px,2px) rotate(0deg)}40%{transform:translate(1px,-1px) rotate(1deg)}50%{transform:translate(-1px,2px) rotate(-1deg)}60%{transform:translate(-3px,1px) rotate(0deg)}70%{transform:translate(3px,1px) rotate(-1deg)}80%{transform:translate(-1px,-1px) rotate(1deg)}90%{transform:translate(1px,2px) rotate(0deg)}to{transform:translate(1px,-2px) rotate(-1deg)}}@keyframes shake{0%{transform:translate(1px,1px) rotate(0deg)}10%{transform:translate(-1px,-2px) rotate(-1deg)}20%{transform:translate(-3px) rotate(1deg)}30%{transform:translate(3px,2px) rotate(0deg)}40%{transform:translate(1px,-1px) rotate(1deg)}50%{transform:translate(-1px,2px) rotate(-1deg)}60%{transform:translate(-3px,1px) rotate(0deg)}70%{transform:translate(3px,1px) rotate(-1deg)}80%{transform:translate(-1px,-1px) rotate(1deg)}90%{transform:translate(1px,2px) rotate(0deg)}to{transform:translate(1px,-2px) rotate(-1deg)}}@media (max-width:1213px){.my_title[_ngcontent-%COMP%]{font-size:25px;margin-left:35%}}@media (max-width:768px){.my_date[_ngcontent-%COMP%], .user[_ngcontent-%COMP%]{display:none}}']}),t})()}];let x=(()=>{class t{}return t.\u0275mod=p.Fb({type:t}),t.\u0275inj=p.Eb({factory:function(e){return new(e||t)},imports:[[a.i.forChild(m)],a.i]}),t})(),O=(()=>{class t{}return t.\u0275mod=p.Fb({type:t}),t.\u0275inj=p.Eb({factory:function(e){return new(e||t)},imports:[[o.b,r.a,i.v,x]]}),t})()}}]);