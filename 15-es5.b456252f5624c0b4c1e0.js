!function(){function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{XpXM:function(n,r,o){"use strict";o.r(r),o.d(r,"MainPageModule",(function(){return _}));var a=o("ofXK"),i=o("3Pt+"),s=o("TEn/"),c=o("tyNb"),u=o("mrSG"),l=o("tk/3"),p=o("z6cu"),d=o("JIr8"),f=o("fXoL"),b=o("e8h1");function g(t,e){if(1&t){var n=f.Lb();f.Kb(0,"ion-button",8),f.Sb("click",(function(){return f.dc(n),f.Wb().reload()})),f.hc(1,"\u91cd\u65b0\u8f09\u5165"),f.Jb()}}function h(t,e){if(1&t){var n=f.Lb();f.Kb(0,"ion-button",8),f.Sb("click",(function(){return f.dc(n),f.Wb().nav2login()})),f.hc(1,"\u767b\u5165"),f.Jb()}}function m(t,e){if(1&t){var n=f.Lb();f.Kb(0,"h1",16),f.Kb(1,"a",17),f.Sb("click",(function(){f.dc(n);var t=f.Wb().$implicit;return f.Wb().sendItem(t.id)})),f.hc(2,"send"),f.Jb(),f.Jb()}}function x(t,e){if(1&t){var n=f.Lb();f.Kb(0,"ion-item"),f.Kb(1,"ion-label",9),f.Sb("click",(function(){f.dc(n);var t=e.$implicit;return f.Wb().nav2update(t.id)})),f.Kb(2,"span",10),f.hc(3),f.Jb(),f.Kb(4,"span",11),f.hc(5),f.Jb(),f.Jb(),f.Kb(6,"span",12),f.hc(7),f.Xb(8,"date"),f.Jb(),f.Kb(9,"span",13),f.hc(10),f.Jb(),f.gc(11,m,3,0,"h1",14),f.Kb(12,"ion-icon",15),f.Sb("click",(function(){f.dc(n);var t=e.$implicit;return f.Wb().DeleteItem(t.id)})),f.Jb(),f.Jb()}if(2&t){var r=e.$implicit,o=f.Wb();f.xb(3),f.ic(" ",r.title," "),f.xb(2),f.ic(" ",r.description," "),f.xb(2),f.ic(" \u6700\u5f8c\u4fee\u6539\u6642\u9593\uff1a ",f.Yb(8,5,r.updated_at,"short")," "),f.xb(3),f.ic(" last edited by ",r.last_edited_by_user.name," "),f.xb(1),f.bc("ngIf",r.last_edited_by_user.name===o.nowUser)}}var v,k,w,O=[{path:"",component:(v=function(){function n(e,r,o,a,i){t(this,n),this.navCtrl=e,this.http=r,this.alertController=o,this.router=a,this.storage=i,this.rawResponse=null,this.errorFlag=!1,this.isCreator=!1,this.accessToken="",this.handleError=function(t){return t.error instanceof ErrorEvent?console.error("An error occurred:",t.error.message):console.error("HTTP status code ".concat(t.status,", reason:"),t.error),Object(p.a)("Something bad happened; please try again later.")}}var r,o,a;return r=n,(o=[{key:"ngOnInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=String,t.next=3,this.storage.get("User");case 3:return t.t1=t.sent,this.nowUser=(0,t.t0)(t.t1),console.log(this.nowUser),t.t2=String,t.next=9,this.storage.get("Token");case 9:t.t3=t.sent,this.accessToken=(0,t.t2)(t.t3),this.initialize();case 12:case"end":return t.stop()}}),t,this)})))}},{key:"initialize",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.getAllNotificationsFromApi();case 3:e=t.sent,console.log(e.data),this.errorFlag=!1,this.data=e.data,this.rawResponse=e,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0),this.errorFlag=!0,Object(d.a)(this.handleError),this.presentErrorAlert();case 10:case"end":return t.stop()}}),t,this,[[0,7]])})))}},{key:"getAllNotificationsFromApi",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={headers:new l.c({Authorization:"Bearer "+this.accessToken})},t.next=3,this.http.get("https://api.cocoing.info/admin/notifications",e).toPromise();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"presentErrorAlert",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertController.create({header:"\u767c\u751f\u932f\u8aa4",message:"\u8f09\u5165\u5931\u6557\uff0c\u8acb\u91cd\u65b0\u8f09\u5165",buttons:["OK"]});case 2:t.sent.present();case 3:case"end":return t.stop()}}),t,this)})))}},{key:"reload",value:function(){this.initialize()}},{key:"DeleteItem",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.DeleteNotificationsFromApi(t);case 3:n=e.sent,console.log({response:n}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("catch error!"),Object(d.a)(this.handleError);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})))}},{key:"DeleteNotificationsFromApi",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var o={id:t},a={headers:new l.c({Authorization:"Bearer "+n.accessToken,"X-HTTP-Method-Override":"delete"})};n.http.post("https://api.cocoing.info/admin/notifications",o,a).subscribe((function(t){console.log(t),n.presentDeleteAlert(),n.reload(),e(t)}),(function(t){console.error(t),n.presentFailDeleteAlert(),r(t)}))})));case 1:case"end":return e.stop()}}),e)})))}},{key:"presentDeleteAlert",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertController.create({header:"\u522a\u9664\u6210\u529f",message:"\u8cc7\u6599\u5df2\u522a\u9664\u6210\u529f",buttons:["OK"]});case 2:t.sent.present();case 3:case"end":return t.stop()}}),t,this)})))}},{key:"presentFailDeleteAlert",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertController.create({header:"\u522a\u9664\u5931\u6557",message:"\u8cc7\u6599\u522a\u9664\u5931\u6557",buttons:["OK"]});case 2:t.sent.present();case 3:case"end":return t.stop()}}),t,this)})))}},{key:"sendItem",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.sendNotificationsFromApi(t);case 3:n=e.sent,console.log({response:n}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("catch error!"),Object(d.a)(this.handleError);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})))}},{key:"sendNotificationsFromApi",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var o={id:t},a={headers:new l.c({Authorization:"Bearer "+n.accessToken})};n.http.post("https://api.cocoing.info/admin/notifications/send",o,a).subscribe((function(t){console.log(t),n.presentSendAlert(),n.reload(),e(t)}),(function(t){console.error(t),n.presentFailSendAlert(),r(t)}))})));case 1:case"end":return e.stop()}}),e)})))}},{key:"presentSendAlert",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertController.create({header:"\u9001\u51fa\u6210\u529f",message:"\u901a\u77e5\u5df2\u6210\u529f\u9001\u51fa",buttons:["OK"]});case 2:t.sent.present();case 3:case"end":return t.stop()}}),t,this)})))}},{key:"presentFailSendAlert",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertController.create({header:"\u9001\u51fa\u5931\u6557",message:"\u901a\u77e5\u9001\u51fa\u5931\u6557",buttons:["OK"]});case 2:t.sent.present();case 3:case"end":return t.stop()}}),t,this)})))}},{key:"add_notification",value:function(){var t=this;this.navCtrl.navigateForward("/add-notification",{state:function(){t.initialize()}})}},{key:"nav2update",value:function(t){var e=this;this.navCtrl.navigateForward("/item-update/"+t,{state:function(){e.reload()}})}},{key:"nav2login",value:function(){this.navCtrl.navigateForward("/login")}}])&&e(r.prototype,o),a&&e(r,a),n}(),v.\u0275fac=function(t){return new(t||v)(f.Hb(s.x),f.Hb(l.a),f.Hb(s.a),f.Hb(c.g),f.Hb(b.b))},v.\u0275cmp=f.Bb({type:v,selectors:[["app-main"]],decls:15,vars:3,consts:[["color","dark"],[1,"my_title"],["slot","end"],[1,"LogOutButton",3,"click"],["expand","full",1,"AddButton",3,"click"],["expand","full","color","danger",3,"click",4,"ngIf"],[1,"ion-text-center"],[4,"ngFor","ngForOf"],["expand","full","color","danger",3,"click"],[1,"item",3,"click"],[1,"myItemTitle"],[1,"myItemDes"],[1,"my_date"],[1,"user"],["class","icon_send",4,"ngIf"],["name","trash-outline",1,"delete_button",2,"cursor","pointer",3,"click"],[1,"icon_send"],[3,"click"]],template:function(t,e){1&t&&(f.Kb(0,"ion-header"),f.Kb(1,"ion-toolbar",0),f.Kb(2,"ion-title",1),f.hc(3,"Main"),f.Jb(),f.Kb(4,"ion-buttons",2),f.Kb(5,"button",3),f.Sb("click",(function(){return e.nav2login()})),f.hc(6,"Logout"),f.Jb(),f.Jb(),f.Jb(),f.Jb(),f.Kb(7,"ion-content"),f.Kb(8,"button",4),f.Sb("click",(function(){return e.add_notification()})),f.hc(9,"\u65b0\u589e\u901a\u77e5"),f.Jb(),f.gc(10,g,2,0,"ion-button",5),f.gc(11,h,2,0,"ion-button",5),f.Kb(12,"div",6),f.Kb(13,"ion-list"),f.gc(14,x,13,8,"ion-item",7),f.Jb(),f.Jb(),f.Jb()),2&t&&(f.xb(10),f.bc("ngIf",e.errorFlag),f.xb(1),f.bc("ngIf",e.errorFlag),f.xb(3),f.bc("ngForOf",e.data))},directives:[s.l,s.u,s.t,s.g,s.j,a.j,s.q,a.i,s.f,s.o,s.p,s.m],pipes:[a.d],styles:['@charset "UTF-8";*[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{font-family:\u5fae\u8edf\u6b63\u9ed1\u9ad4}.ion-text-center[_ngcontent-%COMP%]{border:1px solid #85e0f7;border-radius:20px;padding:10px;margin-top:5%;margin-left:20%;margin-right:20%;box-shadow:0 0 9px #8de6f1}button[_ngcontent-%COMP%]{border:0;margin:20px;text-transform:uppercase;font-size:20px;font-weight:700;padding:15px 60px;border-radius:50px;color:#fff;outline:none;position:relative}button[_ngcontent-%COMP%]:before{content:"";display:block;background:linear-gradient(270deg,hsla(0,0%,100%,0) 50%,hsla(0,0%,100%,.4) 0);background-size:210% 100%;background-position:100% 100%;height:100%;width:100%;position:absolute;top:0;bottom:0;right:0;left:0;border-radius:50px;transition:all 1s;-webkit-transition:all 1s}.LogOutButton[_ngcontent-%COMP%]{border:0;margin:5px;font-size:16px;border-radius:50px;padding:10px;color:#fff;outline:none;position:relative;background-image:linear-gradient(90deg,#e13b25,#e46140);box-shadow:0 2px 15px 0 rgba(248,127,79,.75)}.LogOutButton[_ngcontent-%COMP%]:hover:before{background-position:0 100%}.AddButton[_ngcontent-%COMP%]{margin-left:46.5%;margin-right:45%;border:0;font-size:18px;border-radius:40px;padding:20px;color:#fff;outline:none;background-image:linear-gradient(90deg,#259ce1,#12ddf8);box-shadow:0 2px 15px 0 rgba(20,164,247,.75)}.AddButton[_ngcontent-%COMP%]:hover:before{background-position:0 100%}.my_title[_ngcontent-%COMP%]{font-size:25px;margin-left:51%}.item[_ngcontent-%COMP%], .my_title[_ngcontent-%COMP%]{padding:10px}.myItemTitle[_ngcontent-%COMP%]{top:0;font-weight:bolder}.myItemDes[_ngcontent-%COMP%], .myItemTitle[_ngcontent-%COMP%]{position:absolute;left:5px}.myItemDes[_ngcontent-%COMP%]{top:25px}.my_date[_ngcontent-%COMP%]{top:3px}.my_date[_ngcontent-%COMP%], .user[_ngcontent-%COMP%]{position:absolute;right:100px;font-size:12px;color:grey}.user[_ngcontent-%COMP%]{bottom:5px}.icon_send[_ngcontent-%COMP%]{position:absolute;right:25px;bottom:-3px}.icon_send[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;background-image:url(icon_1.eb54efab3b60d786d2bd.gif);background-size:contain;display:block;text-indent:101%;overflow:hidden;white-space:nowrap;background-repeat:no-repeat}.delete_button[_ngcontent-%COMP%]:hover{color:rgba(240,73,73,.699);-webkit-animation:shake .8s;animation:shake .8s;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite}@-webkit-keyframes shake{0%{transform:translate(1px,1px) rotate(0deg)}10%{transform:translate(-1px,-2px) rotate(-1deg)}20%{transform:translate(-3px) rotate(1deg)}30%{transform:translate(3px,2px) rotate(0deg)}40%{transform:translate(1px,-1px) rotate(1deg)}50%{transform:translate(-1px,2px) rotate(-1deg)}60%{transform:translate(-3px,1px) rotate(0deg)}70%{transform:translate(3px,1px) rotate(-1deg)}80%{transform:translate(-1px,-1px) rotate(1deg)}90%{transform:translate(1px,2px) rotate(0deg)}to{transform:translate(1px,-2px) rotate(-1deg)}}@keyframes shake{0%{transform:translate(1px,1px) rotate(0deg)}10%{transform:translate(-1px,-2px) rotate(-1deg)}20%{transform:translate(-3px) rotate(1deg)}30%{transform:translate(3px,2px) rotate(0deg)}40%{transform:translate(1px,-1px) rotate(1deg)}50%{transform:translate(-1px,2px) rotate(-1deg)}60%{transform:translate(-3px,1px) rotate(0deg)}70%{transform:translate(3px,1px) rotate(-1deg)}80%{transform:translate(-1px,-1px) rotate(1deg)}90%{transform:translate(1px,2px) rotate(0deg)}to{transform:translate(1px,-2px) rotate(-1deg)}}@media (max-width:1213px){.my_title[_ngcontent-%COMP%]{font-size:25px;margin-left:35%}}@media (max-width:768px){.my_date[_ngcontent-%COMP%], .user[_ngcontent-%COMP%]{display:none}}']}),v)}],y=((w=function e(){t(this,e)}).\u0275mod=f.Fb({type:w}),w.\u0275inj=f.Eb({factory:function(t){return new(t||w)},imports:[[c.i.forChild(O)],c.i]}),w),_=((k=function e(){t(this,e)}).\u0275mod=f.Fb({type:k}),k.\u0275inj=f.Eb({factory:function(t){return new(t||k)},imports:[[a.b,i.a,s.v,y]]}),k)}}])}();